---
import BaseLayout from '../layouts/BaseLayout.astro';
import { defaultLang, t } from '@/utils/i18n';
import DownloadButton from '../components/global/DownloadButton.astro';
import PlatformIcon from '../components/global/PlatformIcon.astro';
import VersionAccordion from '../components/global/VersionAccordion.astro';

const lang = defaultLang;
const downloads = t(lang, 'downloads');
const versions = t(lang, 'versions');
---

<BaseLayout
    title='Download Hörgen | Hörgen Radio – Your Underground Frequency'
    desc='Download Hörgen Radio for Windows, Linux, and Android. Experience underground culture with our Electron app and mobile app.'
    lang={lang}
>
    <main class="min-h-screen bg-black">
        {/* Header Section - Minimalista como Cursor */}
        <section class="relative border-white/20 border-b overflow-hidden">
            <div class="mx-auto border-white/20 border-x max-w-7xl">
                <div class="relative px-4 py-16 md:px-8 md:py-24 lg:py-32 text-center flex flex-col items-center justify-center">
                    <div class="absolute inset-0 pointer-events-none z-0">
                        <div class="absolute left-0 top-0 w-64 h-64 bg-orange/10 rounded-full blur-3xl animate-pulse-slow"></div>
                        <div class="absolute right-0 bottom-0 w-64 h-64 bg-eagle/10 rounded-full blur-2xl animate-pulse-slower"></div>
                    </div>
                    
                    <!-- App Icon 
                    <div class="relative z-10 mb-8">
                        <div class="w-24 h-24 bg-black border-2 border-orange/40 rounded-lg flex items-center justify-center">
                            <span class="text-orange font-display text-2xl">H</span>
                        </div>
                    </div> 
                    -->
                    
                    
                    <!-- Title -->
                    <h1 class="relative z-10 text-white font-display uppercase text-2xl sm:text-3xl md:text-4xl lg:text-6xl xl:text-7xl mb-4 md:mb-6 drop-shadow-lg tracking-tight">
                        <span class="bg-gradient-to-r from-orange via-white to-eagle bg-clip-text text-transparent">
                            {downloads.title}
                        </span>
                    </h1>
                    
                    <!-- Platform Detection and Primary Download -->
                    <div class="relative z-10 mb-6 md:mb-8">
                        <div class="mb-3 md:mb-4">
                            <DownloadButton lang={lang} variant="primary" size="lg" />
                        </div>
                        <p class="text-eagle text-xs md:text-sm">{downloads.version} 0.1.4 for <span id="detected-platform-specific" class="text-orange font-semibold">...</span></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- All Versions Section -->
        <section class="border-white/20 border-b bg-black">
            <div class="mx-auto border-white/20 border-x max-w-7xl px-4 md:px-8 py-12 md:py-16">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-0 mb-8 md:mb-12">
                    <h2 class="text-white font-display text-2xl sm:text-3xl lg:text-5xl tracking-tight uppercase">
                        {versions.title}
                    </h2>
                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
                        <span class="text-xl sm:text-2xl font-bold text-white">0.1.4</span>
                        <a href="#" class="text-eagle hover:text-orange transition-colors underline text-sm">
                            {versions.readReleaseNotes}
                        </a>
                        <span class="bg-black text-white px-2 py-1 text-xs font-bold border border-white/20">
                            {versions.latestVersion}
                        </span>
                    </div>
                </div>
                
                <VersionAccordion versions={versions.versions} downloads={downloads} lang={lang} />
            </div>
        </section>
    </main>

    <script>
        // Platform detection for display
        function detectPlatform() {
            const userAgent = navigator.userAgent;
            const platform = navigator.platform;
            
            if (/Android/i.test(userAgent)) {
                return 'android';
            } else if (/Windows/i.test(userAgent) || /Win/i.test(platform)) {
                return 'windows';
            } else if (/Linux/i.test(userAgent) || /Linux/i.test(platform)) {
                return 'linux';
            } else if (/Mac/i.test(userAgent) || /Mac/i.test(platform)) {
                return 'macos';
            } else {
                return 'windows'; // Default fallback
            }
        }

        function updatePlatformDisplay() {
            const platform = detectPlatform();
            const platformNames = {
                'windows': 'Windows 10/11 (x64)',
                'linux': 'Linux (x64)', 
                'android': 'Android (APK)',
                'macos': 'macOS (Intel/Apple Silicon)'
            };
            
            const detectedPlatformEl = document.getElementById('detected-platform-specific');
            
            if (detectedPlatformEl) {
                detectedPlatformEl.textContent = platformNames[platform] || platform;
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', updatePlatformDisplay);
    </script>
</BaseLayout>
